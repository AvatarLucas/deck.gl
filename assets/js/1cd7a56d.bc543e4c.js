"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[3374],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=p(a),m=i,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return a?n.createElement(h,l(l({ref:t},c),{},{components:a})):n.createElement(h,l({ref:t},c))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[d]="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},55650:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var n=a(87462),i=(a(67294),a(3905));const r={},l="HeatmapTileLayer (Experimental)",o={unversionedId:"api-reference/carto/heatmap-tile-layer",id:"api-reference/carto/heatmap-tile-layer",title:"HeatmapTileLayer (Experimental)",description:"HeatmapTileLayer is a layer for visualizing point data aggregated using the Quadbin Spatial Index using a heatmap.",source:"@site/../docs/api-reference/carto/heatmap-tile-layer.md",sourceDirName:"api-reference/carto",slug:"/api-reference/carto/heatmap-tile-layer",permalink:"/docs/api-reference/carto/heatmap-tile-layer",draft:!1,editUrl:"https://github.com/visgl/deck.gl/tree/master/website/../docs/api-reference/carto/heatmap-tile-layer.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"H3TileLayer",permalink:"/docs/api-reference/carto/h3-tile-layer"},next:{title:"QuadbinTileLayer",permalink:"/docs/api-reference/carto/quadbin-tile-layer"}},s={},p=[{value:"Usage",id:"usage",level:2},{value:"Installation",id:"installation",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>data</code> (TilejsonResult)",id:"data",level:4},{value:"Render Options",id:"render-options",level:3},{value:"<code>radiusPixels</code> (number, optional) transition-enabled",id:"radiuspixels",level:4},{value:"<code>colorDomain</code> (number2, optional) transition-enabled",id:"colordomain",level:4},{value:"<code>colorRange</code> (Color[], optional)",id:"colorrange",level:4},{value:"<code>intensity</code> (number, optional) transition-enabled",id:"intensity",level:4},{value:"Data Accessors",id:"data-accessors",level:3},{value:"<code>getWeight</code> (Accessor&lt;number&gt;, optional)",id:"getweight",level:4},{value:"Callbacks",id:"callbacks",level:3},{value:"<code>onMaxDensityChange</code> (Function, optional)",id:"onmaxdensitychange",level:4},{value:"Example",id:"example",level:5}],c={toc:p},d="wrapper";function u(e){let{components:t,...a}=e;return(0,i.kt)(d,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"heatmaptilelayer-experimental"},"HeatmapTileLayer (Experimental)"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"HeatmapTileLayer")," is a layer for visualizing point data aggregated using the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.carto.com/data-and-analysis/analytics-toolbox-for-bigquery/key-concepts/spatial-indexes#quadbin"},"Quadbin Spatial Index")," using a heatmap. "),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx"},"import DeckGL from '@deck.gl/react';\nimport {HeatmapTileLayer, quadbinTableSource} from '@deck.gl/carto';\n\nfunction App({viewState}) {\n  const data = quadbinTableSource({\n    accessToken: 'XXX',\n    connectionName: 'carto_dw',\n    tableName: 'carto-demo-data.demo_tables.quadbin'\n  });\n\n  const layer = new HeatmapTileLayer({\n    data,\n    getWeight: d => d.properties.count\n  })\n\n  return <DeckGL viewState={viewState} layers={[layer]} />;\n}\n")),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"To install the dependencies from NPM:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install deck.gl\n# or\nnpm install @deck.gl/core @deck.gl/layers @deck.gl/carto\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import {HeatmapTileLayer} from '@deck.gl/carto';\nnew HeatmapTileLayer({});\n")),(0,i.kt)("p",null,"To use pre-bundled scripts:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://unpkg.com/deck.gl@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/carto@^9.0.0/dist.min.js"><\/script>\n\n\x3c!-- or --\x3e\n<script src="https://unpkg.com/@deck.gl/core@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/layers@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/geo-layers@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/carto@^9.0.0/dist.min.js"><\/script>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"new deck.carto.HeatmapTileLayer({});\n")),(0,i.kt)("h2",{id:"properties"},"Properties"),(0,i.kt)("p",null,"Inherits from all ",(0,i.kt)("a",{parentName:"p",href:"/docs/api-reference/core/layer"},"Base Layer")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/api-reference/core/composite-layer"},"CompositeLayer")," properties."),(0,i.kt)("h4",{id:"data"},(0,i.kt)("inlineCode",{parentName:"h4"},"data")," (TilejsonResult)"),(0,i.kt)("p",null,"Required. A valid ",(0,i.kt)("inlineCode",{parentName:"p"},"TilejsonResult")," object."),(0,i.kt)("p",null,"Use one of the following ",(0,i.kt)("a",{parentName:"p",href:"/docs/api-reference/carto/data-sources"},"Data Sources")," to fetch this from the CARTO API:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"./data-sources#quadbintablesource"},"quadbinTableSource")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"./data-sources#quadbinquerysource"},"quadbinQuerySource")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"./data-sources#quadbintilesetsource"},"quadbinTilesetSource"))),(0,i.kt)("h3",{id:"render-options"},"Render Options"),(0,i.kt)("h4",{id:"radiuspixels"},(0,i.kt)("inlineCode",{parentName:"h4"},"radiusPixels")," (number, optional) ",(0,i.kt)("img",{parentName:"h4",src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"20"))),(0,i.kt)("p",null,"Radius of the heatmap blur in pixels, to which the weight of a cell is distributed."),(0,i.kt)("h4",{id:"colordomain"},(0,i.kt)("inlineCode",{parentName:"h4"},"colorDomain")," (number","[2]",", optional) ",(0,i.kt)("img",{parentName:"h4",src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"[0, 1]"))),(0,i.kt)("p",null,"Controls how weight values are mapped to the ",(0,i.kt)("inlineCode",{parentName:"p"},"colorRange"),", as an array of two numbers ","[",(0,i.kt)("inlineCode",{parentName:"p"},"minValue"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"maxValue"),"]",". The values are normalized, with a value of ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," corresponding to the maximum density present in the viewport."),(0,i.kt)("p",null,"When ",(0,i.kt)("inlineCode",{parentName:"p"},"colorDomain")," is specified, a pixel with ",(0,i.kt)("inlineCode",{parentName:"p"},"minValue")," is assigned the first color in ",(0,i.kt)("inlineCode",{parentName:"p"},"colorRange"),", a pixel with ",(0,i.kt)("inlineCode",{parentName:"p"},"maxValue")," is assigned the last color in ",(0,i.kt)("inlineCode",{parentName:"p"},"colorRange"),", and any value in between is interpolated. Pixels in the bottom 10% of the range defined by ",(0,i.kt)("inlineCode",{parentName:"p"},"colorDomain")," are gradually faded out by reducing alpha, until 100% transparency at ",(0,i.kt)("inlineCode",{parentName:"p"},"minValue"),". Pixels with weight more than ",(0,i.kt)("inlineCode",{parentName:"p"},"maxValue")," are capped to the last color in ",(0,i.kt)("inlineCode",{parentName:"p"},"colorRange"),"."),(0,i.kt)("h4",{id:"colorrange"},(0,i.kt)("inlineCode",{parentName:"h4"},"colorRange")," (Color[], optional)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("a",{parentName:"li",href:"http://colorbrewer2.org/#type=sequential&scheme=YlOrRd&n=6"},"colorbrewer")," ",(0,i.kt)("inlineCode",{parentName:"li"},"6-class YlOrRd")," ",(0,i.kt)("img",{src:"https://deck.gl/images/colorbrewer_YlOrRd_6.png"}))),(0,i.kt)("p",null,"The color palette used in the heatmap, as an array of colors ","[color1, color2, ...]",". Each color is in the format of ",(0,i.kt)("inlineCode",{parentName:"p"},"[r, g, b]"),". Each channel is a number between 0-255."),(0,i.kt)("h4",{id:"intensity"},(0,i.kt)("inlineCode",{parentName:"h4"},"intensity")," (number, optional) ",(0,i.kt)("img",{parentName:"h4",src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"1"))),(0,i.kt)("p",null,"Value that is multiplied with the total weight at a pixel to obtain the final weight. A value larger than ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," biases the output color towards the higher end of the spectrum, and a value less than ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," biases the output color towards the lower end of the spectrum."),(0,i.kt)("h3",{id:"data-accessors"},"Data Accessors"),(0,i.kt)("h4",{id:"getweight"},(0,i.kt)("inlineCode",{parentName:"h4"},"getWeight")," (",(0,i.kt)("a",{parentName:"h4",href:"/docs/developer-guide/using-layers#accessors"},"Accessor","<","number",">"),", optional)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"1"))),(0,i.kt)("p",null,"Method called to retrieve weight of each quadbin cell. By default each cell will use a weight of ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"."),(0,i.kt)("h3",{id:"callbacks"},"Callbacks"),(0,i.kt)("h4",{id:"onmaxdensitychange"},(0,i.kt)("inlineCode",{parentName:"h4"},"onMaxDensityChange")," (Function, optional)"),(0,i.kt)("p",null,"Function that is called when the maximum density of the displayed data changes. The units correspond to a density, such that a value of ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," is a weight of ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," across the entire world, in Mercator projection space. To obtain the density the layer invokes the ",(0,i.kt)("inlineCode",{parentName:"p"},"getWeight")," accessor on all visible quadbin cells, normalizing by the cell area (",(0,i.kt)("inlineCode",{parentName:"p"},"0.25 ** cellZ"),"). The value is then heurstically adjusted based on the viewport zoom to give smooth transitions when the data changes. "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"null"))),(0,i.kt)("h5",{id:"example"},"Example"),(0,i.kt)("p",null,"A quadbin cell at zoom level ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," with a ",(0,i.kt)("inlineCode",{parentName:"p"},"weight")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"1000")," gives a density of ",(0,i.kt)("inlineCode",{parentName:"p"},"16000")," (",(0,i.kt)("inlineCode",{parentName:"p"},"1000 / (0.25 ** 2)"),"). Upon zooming in, there are different ways the data can be distributed, with the extremes are given here:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"At zoom level ",(0,i.kt)("inlineCode",{parentName:"li"},"3")," the cell splits equally into four cells with weight ",(0,i.kt)("inlineCode",{parentName:"li"},"250"),". The density stays at ",(0,i.kt)("inlineCode",{parentName:"li"},"16000")," (",(0,i.kt)("inlineCode",{parentName:"li"},"250 / (0.25 ** 3)"),")."),(0,i.kt)("li",{parentName:"ul"},"The cell splits into three empty cells and one with weight ",(0,i.kt)("inlineCode",{parentName:"li"},"1000"),". The density increases to ",(0,i.kt)("inlineCode",{parentName:"li"},"64000")," (",(0,i.kt)("inlineCode",{parentName:"li"},"1000 / (0.25 ** 3)"),").")))}u.isMDXComponent=!0}}]);